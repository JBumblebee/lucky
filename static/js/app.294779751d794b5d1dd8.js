webpackJsonp([2,0],{0:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=n(79),o=i(s),r=n(75),a=i(r);n(72),new o.default({el:"#app",render:function(e){return e(a.default)}})},30:function(e,t){"use strict";function n(e,t){var n=document.createRange(),i=window.getSelection();"function"==typeof e.select&&void 0!==e.value?(e.select(),t&&i.collapseToEnd()):"true"===e.contentEditable?(n.selectNodeContents(e),t&&n.collapse(),i.removeAllRanges(),i.addRange(n),e.focus()):e.focus()}function i(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;e.scrollHeight>e.offsetHeight&&s(e,t,-n););}function s(e,t,n){var i=Math.max(parseInt(window.getComputedStyle(e).fontSize,10)+n,t);return i!==t&&(e.style.fontSize=i+"px",!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.focus=n,t.fitByFontSize=i},31:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if("string"==typeof e)localStorage.setItem(e,(0,a.default)(t));else for(var n in e)e.hasOwnProperty(n)&&localStorage.setItem(n,(0,a.default)(e[n]))}function o(e,t){var n=null;"string"==typeof e&&(n=localStorage.getItem(e));try{n=null===n&&void 0!==t?t:JSON.parse(n)}catch(e){n=void 0!==t?t:null}return n}Object.defineProperty(t,"__esModule",{value:!0});var r=n(36),a=i(r);t.save=s,t.load=o},32:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var n=Math.floor((0,c.default)(e))+1;return n>=t?""+e:Array(t-n).fill(0).join("")+e}function o(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;t=Math.min(e.length,t);for(var n=[].concat((0,u.default)(e)),i=n.length,s=0;s<t;s++){var r=Math.floor(Math.random()*(i-s))+s;o(n,s,r)}return n}Object.defineProperty(t,"__esModule",{value:!0});var a=n(39),u=i(a),l=n(37),c=i(l);t.pad=s,t.swap=o,t.shuffle=r},33:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(18),o=i(s),r=n(38),a=i(r),u=n(32),l=n(31),c=n(30),d=n(76),f=i(d),p={candidates:[],winners:[],total:null,round:null,rolling:!1,isSetup:!1,isFit:!0,editing:!1,welcome:(0,l.load)("welcome")||"Who's feeling lucky?"};t.default={name:"lucky",components:{file:f.default},data:function(){return(0,a.default)({},p)},computed:{remaining:{get:function(){return this.isSetup?this.candidates.length:"∞"}}},methods:{setup:function(){this.check("total")&&(this.candidates=Array(this.total).fill(!0).map(function(e,t){return(0,u.pad)(t+1,3)}),this.isSetup=!0)},log:function(e){var t=(0,l.load)("current",[]);t.push(e),(0,l.save)("current",t)},upload:function(e){var t=this,n=e.target,i=n.files[0];if(i){var s=new FileReader;s.onload=function(e){var n=e.target;t.candidates=n.result.split("\n").map(function(e){return e.trim()}).filter(function(e){return e}),t.total=t.candidates.length,t.isSetup=!0,t.focus("round")},s.readAsText(i)}},roll:function(){var e=this;if(this.check("round")){var t=this.round;this.rolling?(this.candidates.splice(0,t),clearTimeout(this.rolling),this.rolling=!1,this.checkRemaining(),this.log(this.winners)):(this.winners=[],this.fit(!0),this.rolling=setInterval(function(){e.shuffle(t),e.fit()},1e3/15),this.focus("begin"))}},shuffle:function(e){var t=(0,u.shuffle)(this.candidates,e);this.winners=t.slice(0,e),this.candidates=t},reset:function(){clearTimeout(this.rolling),this.$refs.upload.clear(),(0,o.default)(this,p),(0,l.save)("previous",(0,l.load)("current")),(0,l.save)("current",[])},checkRemaining:function(){var e="";this.candidates.length<this.round&&(e="剩余人数不足"+this.round+"人。"),this.$refs.round.setCustomValidity(e)},edit:function(e){this.editing=e},click:function(e){var t=e.target;this.$refs.welcome.contains(t)||this.edit(!1)},focus:function(e,t){var n=this.$refs[e];this.$nextTick(function(){n instanceof HTMLElement?(0,c.focus)(n,t):"function"==typeof n.focus&&n.focus()})},check:function(e){var t=this.$refs[e].validationMessage;return!t||(alert(t),!1)},fit:function(e){var t=this,n=this.$refs.winners;e?(this.isFit=!1,n.style.fontSize=""):this.$nextTick(function(){(0,c.fitByFontSize)(n),t.isFit=!0})}},watch:{isSetup:function(e,t){e!==t&&this.focus(e?"round":"total")},editing:function(e,t){e!==t&&(e?this.focus("welcome",!0):(0,l.save)("welcome",this.$refs.welcome.innerHTML))}},mounted:function(){var e=this;window.addEventListener("resize",function(){e.isSetup&&e.fit()}),window.addEventListener("beforeunload",function(){if(e.isSetup)return"目前抽奖尚未结束，是否要离开？"})}}},34:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"file",props:{name:String,disabled:Boolean,accept:String,multiple:Boolean,required:Boolean},methods:{input:function(e){this.$emit("input",e)},change:function(e){this.$emit("change",e)},choose:function(){this.$refs.file.click()},clear:function(){this.$refs.file.value=""}}}},72:function(e,t){},73:function(e,t){},74:function(e,t){},75:function(e,t,n){var i,s;n(74),i=n(33);var o=n(78);s=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(s=i=i.default),"function"==typeof s&&(s=s.options),s.render=o.render,s.staticRenderFns=o.staticRenderFns,e.exports=i},76:function(e,t,n){var i,s;n(73),i=n(34);var o=n(77);s=i=i||{},"object"!=typeof i.default&&"function"!=typeof i.default||(s=i=i.default),"function"==typeof s&&(s=s.options),s.render=o.render,s.staticRenderFns=o.staticRenderFns,e.exports=i},77:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"file"},[n("button",{attrs:{type:"button"},on:{click:e.choose}},[e._t("default",[e._v("选择文件")])],2),e._v(" "),n("input",{ref:"file",attrs:{type:"file",name:e.name,disabled:e.disabled,accept:e.accept,multiple:e.multiple,required:e.required},on:{input:e.input,change:e.change}})])},staticRenderFns:[]}},78:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"},on:{click:e.click}},[n("div",{attrs:{id:"display"}},[n("div",{ref:"winners",style:{visibility:e.winners.length&&e.isFit?"":"hidden"},attrs:{id:"winners"}},e._l(e.winners,function(t){return n("span",{staticClass:"name"},[e._v(e._s(t.split("|")[0])+" "),t.split("|")[1]?n("span",{staticClass:"desc"},[e._v("("+e._s(t.split("|")[1])+")")]):e._e()])})),e._v(" "),n("h1",{directives:[{name:"show",rawName:"v-show",value:!e.winners.length&&e.isFit,expression:"!winners.length && isFit"}],ref:"welcome",attrs:{id:"welcome",contenteditable:e.editing,spellcheck:"false"},domProps:{innerHTML:e._s(e.welcome)},on:{dblclick:function(t){t.stopPropagation(),e.edit(!0)},keydown:function(t){e._k(t.keyCode,"enter",13)||e.edit(!1)}}})]),e._v(" "),n("div",{class:{started:e.isSetup},attrs:{id:"control"}},[n("form",{attrs:{id:"setup"},on:{submit:function(t){t.preventDefault(),e.setup(t)}}},[n("label",[n("file",{ref:"upload",attrs:{disabled:e.isSetup},on:{change:e.upload}},[e._v("选择文件")])],1),e._v(" "),n("span",{staticClass:"separator"},[e._v("- or -")]),e._v(" "),n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.total,expression:"total"}],ref:"total",attrs:{type:"number",required:"",min:"1",max:"999",number:"",disabled:e.isSetup,placeholder:"一共有几人？"},domProps:{value:e._s(e.total)},on:{input:function(t){t.target.composing||(e.total=e._n(t.target.value))},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),n("button",{attrs:{disabled:e.isSetup}},[e._v("确定")])]),e._v(" "),n("form",{attrs:{id:"roll"},on:{reset:e.reset,submit:function(t){t.preventDefault(),e.roll(t)}}},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.round,expression:"round"}],ref:"round",attrs:{type:"number",number:"",required:"",disabled:!this.isSetup||this.rolling,required:"",min:"1",max:e.remaining||50,placeholder:"本轮抽几人？"},domProps:{value:e._s(e.round)},on:{input:[function(t){t.target.composing||(e.round=e._n(t.target.value))},e.checkRemaining],blur:function(t){e.$forceUpdate()}}})]),e._v(" / "),n("span",{staticClass:"remaining"},[e._v(e._s(e.remaining))]),e._v(" "),n("button",{ref:"begin",attrs:{disabled:!e.isSetup,name:"begin"}},[e._v(e._s(e.rolling?"停止":"开始"))]),e._v(" "),n("button",{attrs:{type:"reset",disabled:!e.isSetup}},[e._v("重置")])])])])},staticRenderFns:[]}}});
//# sourceMappingURL=app.294779751d794b5d1dd8.js.map